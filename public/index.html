<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <link rel='stylesheet' href='style.css'>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
  <script src='marker.js'></script>
</head>

<body>
  <script>
    let content = localStorage.getItem('content')
    if (content === null) {
      content = `# This is Markdown

[Markdown](http://daringfireball.net/projects/markdown/) lets you write content in a really natural way.

  * You can have lists, like this one
  * Make things **bold** or *italic*
  * Embed snippets of \`code\`
  * Create [links](/)
  * ...`
    }

    // Init Elm App
    var app = Elm.Marker.init({
      node: document.querySelector('body'),
      flags: {
        content: content
      }
    })

    // Throttle in Elm seems like a PitA atm, do it in js
    var onSave = _.throttle(content => {
      localStorage.setItem('content', content)
    }, 5000)

    // Subscribe to Elm port
    app.ports.save.subscribe(onSave)
  </script>
</body>

</html>
